# Generated by dockerfile_splitter
# ghcr.io/kmmndr/yaroute:latest-ruby

ARG SOURCE_IMAGE_TAG=latest
ARG SOURCE_IMAGE=ghcr.io/kmmndr/yaroute
FROM $SOURCE_IMAGE:${SOURCE_IMAGE_TAG}-base

RUN apk add --no-cache --virtual build-dependencies build-base gcc wget git \
 && apk add --no-cache --virtual ruby-build-dependencies build-dependencies \
      autoconf bison curl-dev libffi-dev gdbm-dev icu-dev ncurses-dev \
      readline-dev openssl-dev libxml2-dev libxslt-dev yaml-dev zlib-dev git \
      sqlite-dev postgresql14-dev

ENV RY_PREFIX=/usr/local
RUN mkdir $RY_PREFIX/lib/ry

RUN mkdir $APP_PATH \
 && chown app $APP_PATH

USER app

ENV GEM_HOME="/home/app/.gem/ruby/$RUBY_VERSION" \
    PATH="/home/app/.gem/ruby/$RUBY_VERSION/bin:$RY_PREFIX/lib/ry/current/bin:$PATH"
RUN gem install bundler

WORKDIR $APP_PATH

###
