# Generated by dockerfile_splitter
# ghcr.io/kmmndr/yaroute:latest-final

ARG SOURCE_IMAGE_TAG=latest
ARG SOURCE_IMAGE=ghcr.io/kmmndr/yaroute
FROM $SOURCE_IMAGE:${SOURCE_IMAGE_TAG}-build as build

ARG SOURCE_IMAGE_TAG=latest
ARG SOURCE_IMAGE=ghcr.io/kmmndr/yaroute
FROM $SOURCE_IMAGE:${SOURCE_IMAGE_TAG}-base

COPY --from=build /usr/local/lib/ry /usr/local/lib/ry
COPY --from=build /home/app/.gem /home/app/.gem
COPY --from=build $APP_PATH $APP_PATH

USER app
ENV PATH="/home/app/.gem/ruby/$RUBY_VERSION/bin:/usr/local/lib/ry/current/bin:$PATH"

WORKDIR $APP_PATH

EXPOSE 3000
CMD ["/srv/app/entrypoint.sh"]
